<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>OpenANN: Two Spirals</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="openann-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenANN
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">An open source library for artificial neural networks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Two Spirals </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="DataSet"></a>
Data Set</h1>
<p>This is a classification benchmark which is particularly difficult for gradient descent optimization.</p>
<p>The two spirals data set was developed by Lang and Witbrock [1]. The data set we use here is taken from the <a href="http://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/areas/neural/bench/0.html" target="_blank">CMU Neural Networks Benchmarks</a>. It consists of 193 training instances and 193 test instances located on a 2D surface. They belong to one of two spirals:</p>
<div class="image">
<img src="TwoSpirals-DataSet.png" alt="TwoSpirals-DataSet.png"/>
</div>
<h1><a class="anchor" id="NetworkArchitecture"></a>
Network Architecture</h1>
<p>It is possible to solve this problem with one or two hidden layers. But architectures with two hidden layers need less connections and can learn faster. The architecture we chose here is 2-20-20-1 with bias. You can solve this problem with different compression setups. the smallest number of parameters that reliably solves this problem is 3-6-1 with orthogonal cosine functions. All activation functions are tangens hyperbolicus (MLP::TANH). The best optimization algorithm is Levenberq-Marquardt (MLP::BATCH_LMA).</p>
<h1><a class="anchor" id="UI"></a>
User Interface</h1>
<p>You can use the following keys to control the program:</p>
<ul>
<li>Q: Toggle display of training set</li>
<li>W: Toggle display of test set</li>
<li>E: Toggle display of predicted classes for the whole surface</li>
<li>R: Toggle display of smooth prediction transitions (black+white or grey)</li>
<li>A: Start visible training</li>
<li>Escape: Quit application.</li>
</ul>
<p>A trained model could make these predictions:</p>
<div class="image">
<img src="TwoSpirals-Model.png" alt="TwoSpirals-Model.png"/>
</div>
<h1><a class="anchor" id="References"></a>
References</h1>
<p>[1] Kevin J. Lang and Michael J. Witbrock: Learning to Tell Two Spirals Apart. In: Proceedings of the 1988 Connectionist Models Summer School,</p>
<ol type="1">
<li>ISBN: 0-55860-015-9</li>
</ol>
<h1><a class="anchor" id="Code"></a>
Code</h1>
<p>Note that you should not use this as an example for good GUI code because it mixes a lot of logic and visualization.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TwoSpiralsVisualization_8h.html">TwoSpiralsVisualization.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="OpenANN.html">OpenANN/OpenANN</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="CreateTwoSpiralsDataSet_8h.html">CreateTwoSpiralsDataSet.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#ifdef PARALLEL_CORES</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="dpb_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceOpenANN.html#a6a153f194c879b59d808a12f2b9e83c4" title="Enable all cores for OpenMP.">useAllCores</a>(); <span class="comment">// Enable all cores (must be specified during build)</span></div>
<div class="line">  OpenANNLibraryInfo::print();</div>
<div class="line">  QApplication app(argc, argv);</div>
<div class="line"></div>
<div class="line">  Eigen::MatrixXd Xtr, Ytr, Xte, Yte;</div>
<div class="line">  <a class="code" href="CreateTwoSpiralsDataSet_8h.html#aa5fae563fca26881280160ea025dceda" title="Creates two interlocked spirals that form different classes.">createTwoSpiralsDataSet</a>(2, 1.0, Xtr, Ytr, Xte, Yte);</div>
<div class="line">  <a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a> visual(Xtr, Ytr, Xte, Yte);</div>
<div class="line">  visual.show();</div>
<div class="line">  visual.resize(500, 500);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> app.exec();</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="preprocessor">#ifndef TWO_SPIRALS_VISUALIZATION_H_</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define TWO_SPIRALS_VISUALIZATION_H_</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="OpenANN.html">OpenANN/OpenANN</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="DirectStorageDataSet_8h.html">OpenANN/io/DirectStorageDataSet.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QGLWidget&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QKeyEvent&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QMutex&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>OpenANN;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classTwoSpiralsDataSet.html">TwoSpiralsDataSet</a> : <span class="keyword">public</span> <a class="code" href="classOpenANN_1_1DataSet.html" title="Data set interface.">DataSet</a></div>
<div class="line">{</div>
<div class="line">  Eigen::MatrixXd in, out;</div>
<div class="line">  <a class="code" href="classOpenANN_1_1DirectStorageDataSet.html" title="Stores the inputs and outputs of the data set directly in two matrices.">DirectStorageDataSet</a> dataSet;</div>
<div class="line">  <a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a>* visualization;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code" href="classTwoSpiralsDataSet.html">TwoSpiralsDataSet</a>(<span class="keyword">const</span> Eigen::MatrixXd&amp; inputs, <span class="keyword">const</span> Eigen::MatrixXd&amp; outputs);</div>
<div class="line">  <span class="keywordtype">void</span> setVisualization(<a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a>* visualization);</div>
<div class="line">  <span class="keyword">virtual</span> ~<a class="code" href="classTwoSpiralsDataSet.html">TwoSpiralsDataSet</a>() {}</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">int</span> samples() { <span class="keywordflow">return</span> dataSet.samples(); }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">int</span> inputs() { <span class="keywordflow">return</span> dataSet.inputs(); }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">int</span> outputs() { <span class="keywordflow">return</span> dataSet.outputs(); }</div>
<div class="line">  <span class="keyword">virtual</span> Eigen::VectorXd&amp; getInstance(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> dataSet.getInstance(i); }</div>
<div class="line">  <span class="keyword">virtual</span> Eigen::VectorXd&amp; getTarget(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> dataSet.getTarget(i); }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> finishIteration(<a class="code" href="classOpenANN_1_1Learner.html" title="Common base class of all learning algorithms.">Learner</a>&amp; learner);</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a> : <span class="keyword">public</span> QGLWidget</div>
<div class="line">{</div>
<div class="line">  Q_OBJECT</div>
<div class="line">  <span class="keywordtype">int</span> width, height;</div>
<div class="line">  QMutex classesMutex;</div>
<div class="line">  <span class="keywordtype">double</span> classes[100][100];</div>
<div class="line">  <a class="code" href="classTwoSpiralsDataSet.html">TwoSpiralsDataSet</a> trainingSet;</div>
<div class="line">  <a class="code" href="classTwoSpiralsDataSet.html">TwoSpiralsDataSet</a> testSet;</div>
<div class="line">  <span class="keywordtype">bool</span> showTraining, showTest, showPrediction, showSmooth;</div>
<div class="line">  <a class="code" href="classOpenANN_1_1Net.html" title="Feedforward multilayer neural network.">Net</a>* <a class="code" href="agent_8cpp.html#a474ff98ad9b3a9eb55cfd3c3d4ec5e38">net</a>;</div>
<div class="line">  <a class="code" href="classOpenANN_1_1StoppingCriteria.html" title="Stopping criteria for optimization algorithms.">StoppingCriteria</a> <a class="code" href="namespacesine.html#a5d8451dc96d4f2326024d9b8c7bad74f">stop</a>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a>(<span class="keyword">const</span> Eigen::MatrixXd&amp; trainingInput, <span class="keyword">const</span> Eigen::MatrixXd&amp; trainingOutput,</div>
<div class="line">                          <span class="keyword">const</span> Eigen::MatrixXd&amp; testInput, <span class="keyword">const</span> Eigen::MatrixXd&amp; testOutput);</div>
<div class="line">  <span class="keyword">virtual</span> ~<a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a>();</div>
<div class="line">  <span class="keywordtype">void</span> predictClass(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="namespacexor.html#ac10c3225dba7d99e545014d575bd3af4">y</a>, <span class="keywordtype">double</span> predictedClass);</div>
<div class="line"></div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> initializeGL();</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> resizeGL(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height);</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> paintGL();</div>
<div class="line">  <span class="keywordtype">void</span> paintPrediction();</div>
<div class="line">  <span class="keywordtype">void</span> paintDataSet(<span class="keywordtype">bool</span> training);</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> keyPressEvent(QKeyEvent* keyEvent);</div>
<div class="line"></div>
<div class="line">signals:</div>
<div class="line">  <span class="keywordtype">void</span> updatedData();</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif // TWO_SPIRALS_VISUALIZATION_H_</span></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TwoSpiralsVisualization_8h.html">TwoSpiralsVisualization.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="AssertionMacros_8h.html">OpenANN/util/AssertionMacros.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;GL/glu.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classTwoSpiralsVisualization.html#aab132c0d469407e52eb210f15855ad9d">TwoSpiralsVisualization::TwoSpiralsVisualization</a>(</div>
<div class="line">  <span class="keyword">const</span> Eigen::MatrixXd&amp; trainingInput,</div>
<div class="line">  <span class="keyword">const</span> Eigen::MatrixXd&amp; trainingOutput,</div>
<div class="line">  <span class="keyword">const</span> Eigen::MatrixXd&amp; testInput,</div>
<div class="line">  <span class="keyword">const</span> Eigen::MatrixXd&amp; testOutput)</div>
<div class="line">  : width(500), height(500),</div>
<div class="line">    trainingSet(trainingInput, trainingOutput),</div>
<div class="line">    testSet(testInput, testOutput), showTraining(true), showTest(true),</div>
<div class="line">    showPrediction(true), showSmooth(true), net(new Net)</div>
<div class="line">{</div>
<div class="line">  std::memset(classes, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * 100 * 100);</div>
<div class="line">  trainingSet.setVisualization(<span class="keyword">this</span>);</div>
<div class="line">  QObject::connect(<span class="keyword">this</span>, SIGNAL(updatedData()), <span class="keyword">this</span>, SLOT(repaint()));</div>
<div class="line"></div>
<div class="line">  <span class="comment">// initialize MLP</span></div>
<div class="line">  net-&gt;<a class="code" href="classOpenANN_1_1Net.html#a75298fe2108bc0eabd3e4fe934a05214" title="Add an input layer.">inputLayer</a>(trainingSet.inputs())</div>
<div class="line">  <span class="comment">// use this as only hidden layer to try extreme learning machine</span></div>
<div class="line">  <span class="comment">//.extremeLayer(1500, RECTIFIER, 1.0)</span></div>
<div class="line">  .fullyConnectedLayer(20, <a class="code" href="namespaceOpenANN.html#a90e479eb54bb177043ce063427022968a46423bdbbb11f9476b855af34db6276c" title="Tanh sigmoid function.">TANH</a>)</div>
<div class="line">  .<a class="code" href="classOpenANN_1_1Net.html#a3e5158881a78172285ebb96a4d5411d6" title="Add a fully connected hidden layer.">fullyConnectedLayer</a>(20, <a class="code" href="namespaceOpenANN.html#a90e479eb54bb177043ce063427022968a46423bdbbb11f9476b855af34db6276c" title="Tanh sigmoid function.">TANH</a>)</div>
<div class="line">  .<a class="code" href="classOpenANN_1_1Net.html#ab409e4c62955b5f175f3faea40b8ba80" title="Add a fully connected output layer.">outputLayer</a>(trainingSet.outputs(), <a class="code" href="namespaceOpenANN.html#a90e479eb54bb177043ce063427022968a46423bdbbb11f9476b855af34db6276c" title="Tanh sigmoid function.">TANH</a>)</div>
<div class="line">  .trainingSet(trainingSet);</div>
<div class="line">  net-&gt;<a class="code" href="classOpenANN_1_1Net.html#a9c801063aa52901c31bd51016c026d82" title="Initialize the optimizable parameters.">initialize</a>();</div>
<div class="line"></div>
<div class="line">  <span class="comment">// set stop criteria</span></div>
<div class="line">  stop.<a class="code" href="classOpenANN_1_1StoppingCriteria.html#a9992544e16dbef7a61b3796195952470" title="Maximal number of optimization algorithm iterations.">maximalIterations</a> = 10000;</div>
<div class="line">  stop.<a class="code" href="classOpenANN_1_1StoppingCriteria.html#a01314acfb86728440d38185e9c1576ce" title="Minimal step size in the search step (e.">minimalSearchSpaceStep</a> = 1e-8;</div>
<div class="line">  stop.<a class="code" href="classOpenANN_1_1StoppingCriteria.html#adb37c8f3a5ff2657f7c876c36d75ff9b" title="Minimal objective function difference between iterations.">minimalValueDifferences</a> = 1e-8;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="classTwoSpiralsVisualization.html#a3f78de58c5a87c5b40d5103ebf161d68">TwoSpiralsVisualization::~TwoSpiralsVisualization</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">delete</span> <a class="code" href="agent_8cpp.html#a474ff98ad9b3a9eb55cfd3c3d4ec5e38">net</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#af3134cb419527f9307237069f1bb0dd9">TwoSpiralsVisualization::predictClass</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="namespacexor.html#ac10c3225dba7d99e545014d575bd3af4">y</a>, <span class="keywordtype">double</span> predictedClass)</div>
<div class="line">{</div>
<div class="line">  classesMutex.lock();</div>
<div class="line">  classes[x][<a class="code" href="namespacexor.html#ac10c3225dba7d99e545014d575bd3af4">y</a>] = predictedClass;</div>
<div class="line">  classesMutex.unlock();</div>
<div class="line">  <span class="keywordflow">if</span>(x == 99 &amp;&amp; y == 99)</div>
<div class="line">    emit updatedData();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#a0ada44fff8680d6c2277828dcd80c560">TwoSpiralsVisualization::initializeGL</a>()</div>
<div class="line">{</div>
<div class="line">  glEnable(GL_DEPTH_TEST);</div>
<div class="line">  glEnable(GL_LINE_SMOOTH);</div>
<div class="line">  glHint(GL_LINE_SMOOTH_HINT, GL_NICEST);</div>
<div class="line">  glEnable(GL_BLEND);</div>
<div class="line">  glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);</div>
<div class="line">  glDepthFunc(GL_LEQUAL);</div>
<div class="line">  glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);</div>
<div class="line">  glShadeModel(GL_SMOOTH);</div>
<div class="line">  glClearColor(0.0, 0.0, 0.0, 0.0);</div>
<div class="line">  glPointSize(5.0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#a95209e1903920255c7095c269c35d878">TwoSpiralsVisualization::resizeGL</a>(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height)</div>
<div class="line">{</div>
<div class="line">  this-&gt;width = width;</div>
<div class="line">  this-&gt;height = height;</div>
<div class="line">  glViewport(0, 0, width, height);</div>
<div class="line">  glMatrixMode(GL_PROJECTION);</div>
<div class="line">  glLoadIdentity();</div>
<div class="line">  gluPerspective(45.0f, (<span class="keywordtype">float</span>) width / (<span class="keywordtype">float</span>) height, 1.0f, 100.0f);</div>
<div class="line">  glMatrixMode(GL_MODELVIEW);</div>
<div class="line">  glClearColor(0.0, 0.0, 0.0, 0.0);</div>
<div class="line">  glClearDepth(1.0f);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#a67e7d23440236aa0a9ea4a65a97e4a76">TwoSpiralsVisualization::paintGL</a>()</div>
<div class="line">{</div>
<div class="line">  glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</div>
<div class="line">  glLoadIdentity();</div>
<div class="line">  glTranslatef(-0.5f, -0.5f, -1.25f);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(showPrediction)</div>
<div class="line">    paintPrediction();</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(showTraining)</div>
<div class="line">    paintDataSet(<span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(showTest)</div>
<div class="line">    paintDataSet(<span class="keyword">false</span>);</div>
<div class="line"></div>
<div class="line">  glFlush();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#adf775cec19dd3df6033a72da52cc29c7">TwoSpiralsVisualization::paintPrediction</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 0; x &lt; 100; x++)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; 100; y++)</div>
<div class="line">    {</div>
<div class="line">      classesMutex.lock();</div>
<div class="line">      <span class="keywordtype">float</span> c;</div>
<div class="line">      Eigen::VectorXd v(2);</div>
<div class="line">      v(0) = (double) x / 100.0f;</div>
<div class="line">      v(1) = (double) y / 100.0f;</div>
<div class="line">      <span class="keywordflow">if</span>(showSmooth)</div>
<div class="line">        c = classes[x][<a class="code" href="namespacexor.html#ac10c3225dba7d99e545014d575bd3af4">y</a>] / 2.0f + 0.5f;</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        c = classes[x][<a class="code" href="namespacexor.html#ac10c3225dba7d99e545014d575bd3af4">y</a>] &lt; 0.0 ? 0.0f : 1.0f;</div>
<div class="line">      classesMutex.unlock();</div>
<div class="line">      glColor3f(c, c, c);</div>
<div class="line">      <span class="keywordtype">float</span> minX = (float) x / 100.0f - 0.005;</div>
<div class="line">      <span class="keywordtype">float</span> maxX = minX + 0.01;</div>
<div class="line">      <span class="keywordtype">float</span> minY = (float) y / 100.0f - 0.005;</div>
<div class="line">      <span class="keywordtype">float</span> maxY = minY + 0.01;</div>
<div class="line">      glBegin(GL_QUADS);</div>
<div class="line">      glVertex2f(minX, maxY);</div>
<div class="line">      glVertex2f(maxX, maxY);</div>
<div class="line">      glVertex2f(maxX, minY);</div>
<div class="line">      glVertex2f(minX, minY);</div>
<div class="line">      glEnd();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#acee0eae6984260d5b53d3a46b57c2974">TwoSpiralsVisualization::paintDataSet</a>(<span class="keywordtype">bool</span> training)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTwoSpiralsDataSet.html">TwoSpiralsDataSet</a>&amp; dataSet = training ? trainingSet : testSet;</div>
<div class="line">  glBegin(GL_POINTS);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt; dataSet.<a class="code" href="classTwoSpiralsDataSet.html#ac979dabc02cee219d56b9c0cd8eb976c" title="Number of instances.">samples</a>(); n++)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(dataSet.<a class="code" href="classTwoSpiralsDataSet.html#a642f36588e80bc2f8c40e929b20f1204" title="Get the output of the ith instance.">getTarget</a>(n)(0) &gt; 0.0)</div>
<div class="line">      glColor3f(1.0f, 0.0f, 0.0f);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      glColor3f(1.0f, 1.0f, 0.0f);</div>
<div class="line">    glVertex2d(dataSet.<a class="code" href="classTwoSpiralsDataSet.html#acec1697aaa0cd113a073477a2284e6bf" title="Get the input of the ith instance.">getInstance</a>(n)(0), dataSet.<a class="code" href="classTwoSpiralsDataSet.html#acec1697aaa0cd113a073477a2284e6bf" title="Get the input of the ith instance.">getInstance</a>(n)(1));</div>
<div class="line">  }</div>
<div class="line">  glEnd();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsVisualization.html#aa3ea7431d5233199d7ff790b990a07d5">TwoSpiralsVisualization::keyPressEvent</a>(QKeyEvent* keyEvent)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">switch</span>(keyEvent-&gt;key())</div>
<div class="line">  {</div>
<div class="line">  <span class="keywordflow">case</span> Qt::Key_Q:</div>
<div class="line">    <a class="code" href="Logger_8h.html#aaf8810a28fbc8226ffbf01c99477d364" title="Log an info message.">OPENANN_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Switching training set on/off.&quot;</span>;</div>
<div class="line">    showTraining = !showTraining;</div>
<div class="line">    update();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Qt::Key_W:</div>
<div class="line">    <a class="code" href="Logger_8h.html#aaf8810a28fbc8226ffbf01c99477d364" title="Log an info message.">OPENANN_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Switching test set on/off.&quot;</span>;</div>
<div class="line">    showTest = !showTest;</div>
<div class="line">    update();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Qt::Key_E:</div>
<div class="line">    <a class="code" href="Logger_8h.html#aaf8810a28fbc8226ffbf01c99477d364" title="Log an info message.">OPENANN_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Switching prediction on/off.&quot;</span>;</div>
<div class="line">    showPrediction = !showPrediction;</div>
<div class="line">    update();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Qt::Key_R:</div>
<div class="line">    <a class="code" href="Logger_8h.html#aaf8810a28fbc8226ffbf01c99477d364" title="Log an info message.">OPENANN_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Switching smooth classes on/off.&quot;</span>;</div>
<div class="line">    showSmooth = !showSmooth;</div>
<div class="line">    update();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Qt::Key_A:</div>
<div class="line">    <a class="code" href="Logger_8h.html#aaf8810a28fbc8226ffbf01c99477d364" title="Log an info message.">OPENANN_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Training with restart (&quot;</span> &lt;&lt; net-&gt;<a class="code" href="classOpenANN_1_1Net.html#a00025e5ee0013e8adf80bd3d35c86074" title="Request the number of optimizable parameters.">dimension</a>() &lt;&lt; <span class="stringliteral">&quot; parameters)...&quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceOpenANN.html#a5fcdd987e4be42f5de6109e26c9691a5" title="Train a feedforward neural network supervised.">train</a>(*net, <span class="stringliteral">&quot;LMA&quot;</span>, <a class="code" href="namespaceOpenANN.html#a051970efc9e88e608fbe5cf52db8e87da725f9bfc7b6ef4358c13159ed28bbf3b" title="Mean squared error (regression, two classes)">MSE</a>, stop, <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Qt::Key_Escape:</div>
<div class="line">    <a class="code" href="Logger_8h.html#aaf8810a28fbc8226ffbf01c99477d364" title="Log an info message.">OPENANN_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Quitting application.&quot;</span>;</div>
<div class="line">    QApplication::quit();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    QGLWidget::keyPressEvent(keyEvent);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="classTwoSpiralsDataSet.html#a4eeb5a78bc7bcd7e7b0148c305b124e1">TwoSpiralsDataSet::TwoSpiralsDataSet</a>(<span class="keyword">const</span> Eigen::MatrixXd&amp; inputs, <span class="keyword">const</span> Eigen::MatrixXd&amp; outputs)</div>
<div class="line">  : in(inputs), out(outputs), dataSet(&amp;this-&gt;in, &amp;this-&gt;out), visualization(0)</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsDataSet.html#ae0476708fc311c3e2e09941967c3b1ff">TwoSpiralsDataSet::setVisualization</a>(<a class="code" href="classTwoSpiralsVisualization.html">TwoSpiralsVisualization</a>* visualization)</div>
<div class="line">{</div>
<div class="line">  this-&gt;visualization = visualization;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classTwoSpiralsDataSet.html#a82d58dbeb09cb510703b78a42aa8411a" title="This function is called after an iteration of the optimization algorithm.">TwoSpiralsDataSet::finishIteration</a>(Learner&amp; learner)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span>(visualization)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 0; x &lt; 100; x++)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; 100; y++)</div>
<div class="line">      {</div>
<div class="line">        Eigen::VectorXd in(2);</div>
<div class="line">        in &lt;&lt; (double) x / 100.0, (<span class="keywordtype">double</span>) y / 100.0;</div>
<div class="line">        Eigen::VectorXd out = learner(in);</div>
<div class="line">        visualization-&gt;predictClass(x, y, out(0, 0));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 26 2013 23:29:29 for OpenANN by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
